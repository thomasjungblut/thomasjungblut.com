{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogger/particle-swarm-optimization/","result":{"data":{"site":{"siteMetadata":{"title":"Coding with Thomas"}},"markdownRemark":{"id":"4accb054-cb8a-5575-8023-950669495bb5","excerpt":"Hey there, I recently started to attend a artificial intelligence lecture (a real course, not online) and we have gotten a small intro to NetLogo yesterday…","html":"<p>Hey there,</p>\n<p>I recently started to attend a artificial intelligence lecture (a real course, not online) and we have gotten a small intro to <a href=\"http://ccl.northwestern.edu/netlogo/\">NetLogo</a> yesterday. Although I’m not a real fan of it (mainly because I was tortured with LOGO as a kid, you don’t know how painful it is if you already know C++), I liked the idea of plotting agents and scripting all kinds of logic in a compressed way.</p>\n<p>So I used to came across an example in their modules library called “Particle Swarm Optimization” (PSO), which was really amazing. I can give you a small picture of it:</p>\n<p><a href=\"http://ccl.northwestern.edu/netlogo/models/models/Sample%20Models/Computer%20Science/Particle%20Swarm%20Optimization.png\"><img src=\"http://ccl.northwestern.edu/netlogo/models/models/Sample%20Models/Computer%20Science/Particle%20Swarm%20Optimization.png\" alt=\"\"></a></p>\n<p>You can see a lot of colored particles (or agents) and a terrain that is greyscaled according to its height. Your job is to find a pretty good minimum (whitened areas) in this terrain via swarm intelligence.</p>\n<p>A short summary is, that if you have a function and want to minimize the cost by a given parameter set “Theta”, you can use the PSO algorithm to find a good minimum of your function. You can compare this for example with <a href=\"http://en.wikipedia.org/wiki/Gradient_descent\">Gradient Descent</a> or <a href=\"http://codingwiththomas.blogspot.de/2012/02/nonlinear-conjugate-gradient-method-in.html\">Conjugate Gradient</a>, but there is a subtle difference between them, for PSO <strong>no</strong> differentiable function is needed.</p>\n<p><strong>Intuition</strong><br>\nOf course I will provide you with the basic intuition of this algorithm. So I told that there is a certain number of agents in this algorithm. They are initialized uniformly distributed in our search space, ideally you want to fill the map to get a good spread of your agents so your chance is higher to find a global minimum.</p>\n<p>For a fixed number of iterations, you are going to change the position of each particle randomized with a weight on three objectives which are parameters of this meta-optimizer.</p>\n<ul>\n<li>\n<p>Alpha (in literature also called φp / Phi_personal) is the weight of an agent following its personal memory (based on prior found minimas)</p>\n</li>\n<li>\n<p>Beta (in literature also called φg / Phi_global) is the weight of an agent following the global memory of the swarm (based on the currently best minimum from the swarm)</p>\n</li>\n<li>\n<p>Phi (in literature also called ω / Omega) is the inertia/velocity of an agent.</p>\n</li>\n</ul>\n<p>From the parameters you can tell that each particle has its own memory (the best personal found solution), also there is a swarm memory, which basically is just a record of the currently best found solution from all particles.</p>\n<p><strong>Math</strong></p>\n<p>To understand the weighted formula of the movement of the particles, we have to have a look at the formula:</p>\n<p><a href=\"http://2.bp.blogspot.com/-DpQysZPk2R8/UEJW_u6JS4I/AAAAAAAABlI/VCXKbWbf1rE/s1600/PSO_formula.png\"><img src=\"http://2.bp.blogspot.com/-DpQysZPk2R8/UEJW_u6JS4I/AAAAAAAABlI/VCXKbWbf1rE/s1600/PSO_formula.png\" alt=\"\"></a></p>\n<p>Formula to calculate the new position of a particle, based on the current position “v”</p>\n<p>You can see, to calculate the movement of a particle, you have a weighted radomized linear combination of the above parameters. Non-mathematically interpreted, the agent is on the move and it is attracted to either its personal best solution or the global best solution. By setting the parameters you can fine tune the behaviour of each particle in this regard.</p>\n<p><strong>Algorithm</strong></p>\n<p>The algorithm is quite easy, because there is some really good <a href=\"http://en.wikipedia.org/wiki/Particle_swarm_optimization#Algorithm\">pseudo code on Wikipedia</a>.<br>\nHowever here is my small summary of it:</p>\n<ul>\n<li>Initialize…</li>\n<li>the particle positions to some random positions in our search space</li>\n<li>the memorys of the agents and the swarm memory</li>\n<li>In each iteration until we haven’t hit our maximum iterations do…</li>\n<li>loop over all particles</li>\n<li>calculate the new position of a particle</li>\n<li>check the cost of this position, if its smaller than the particles memory then update, do the same update with the global memory if its smaller.</li>\n<li>Profit!</li>\n</ul>\n<p>This is a nice and easy algorithm. To further visualize it, I have found a very good youtube video about it, implemented with MatLab: <a href=\"http://www.youtube.com/watch?v=bbbUwyMr1W8\">http://www.youtube.com/watch?v=bbbUwyMr1W8</a></p>\n<p>There you can see the movement of the particles very well for a number of functions.</p>\n<p><strong>In Java</strong></p>\n<p>Of course I have done this in Java with my math library. So let’s dive into my normal testcase of the function </p>\n<p><a href=\"http://3.bp.blogspot.com/-0Dmi4vOcBxQ/UEJarslc9aI/AAAAAAAABlY/cwC66p0O4ME/s1600/chart.png\"><img src=\"http://3.bp.blogspot.com/-0Dmi4vOcBxQ/UEJarslc9aI/AAAAAAAABlY/cwC66p0O4ME/s1600/chart.png\" alt=\"\"></a></p>\n<p>Which is a good testcase, because it is convex so it has a global minimum which can be good tested.</p>\n<p>A nice looking plot of it:</p>\n<p><a href=\"http://4.bp.blogspot.com/-GciilGLgVmY/UEJdsNu0U5I/AAAAAAAABlo/nooMsAo_yik/s1600/plot.png\"><img src=\"http://4.bp.blogspot.com/-GciilGLgVmY/UEJdsNu0U5I/AAAAAAAABlo/nooMsAo_yik/s320/plot.png\" alt=\"\"></a></p>\n<p>Convex function f(x,y) = x^2 + y^2</p>\n<p>Let’s sneak into the Java code:</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">DoubleVector</span> start <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DenseDoubleVector</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token keyword\">double</span>\\<span class=\"token punctuation\">[</span>\\<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">{</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n\n<span class=\"token comment\">// our function is f(x,y) = x^2+y^2  </span>\n<span class=\"token class-name\">CostFunction</span> inlineFunction <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">CostFunction</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  <span class=\"token annotation punctuation\">@Override</span>  \n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">Tuple</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">DoubleVector</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">evaluateCost</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DoubleVector</span> input<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n\n    <span class=\"token keyword\">double</span> cost <span class=\"token operator\">=</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Tuple</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Double</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">DoubleVector</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>  \n\n<span class=\"token class-name\">DoubleVector</span> theta <span class=\"token operator\">=</span> <span class=\"token class-name\">ParticleSwarmOptimization</span><span class=\"token punctuation\">.</span><span class=\"token function\">minimizeFunction</span><span class=\"token punctuation\">(</span>  \n    inlineFunction<span class=\"token punctuation\">,</span> start<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token comment\">// retrieve the optimal parameters from theta  </span>\n </code></pre></div>\n<p>We run 1000 particles for 100 iterations, with a weight of 0.1 to the personal best solution, 0.2 to the swarm solution and 0.4 for its own exploration. Basically this was the usage of the algorithm, you can see that we don’t need a gradient in this computation (it is nulled). Theta in this case should contain a value close to zero.</p>\n<p>Of course you can find the <a href=\"https://github.com/thomasjungblut/thomasjungblut-common/blob/master/src/main/java/de/jungblut/math/minimize/ParticleSwarmOptimization.java\">source code here</a>.</p>\n<p>And the <a href=\"https://github.com/thomasjungblut/thomasjungblut-common/blob/master/src/test/java/de/jungblut/math/minimize/ParticleSwarmOptimizationTest.java\">testcase above in here</a>.</p>","frontmatter":{"title":"Particle Swarm Optimization","date":"1st September 2012","description":null},"tableOfContents":"","timeToRead":3},"previous":{"fields":{"slug":"/blogger/creating-semantic-graph/"},"frontmatter":{"title":"Creating a semantic graph"}},"next":{"fields":{"slug":"/blogger/java-xor-swap-performance/"},"frontmatter":{"title":"Java XOR Swap Performance"}}},"pageContext":{"id":"4accb054-cb8a-5575-8023-950669495bb5","previousPostId":"99720750-fc40-550d-8aa1-4cea78802115","nextPostId":"17ac235e-f4ed-5968-b37b-f3f6a70ba821"}},"staticQueryHashes":["2270107033","2841359383"],"slicesMap":{}}